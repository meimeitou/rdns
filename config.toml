# rdns 配置文件示例

# 要监控的网卡列表（支持多个）
interfaces = ["enp0s3", "enp0s8"]

[server]
# HTTP API 监听地址
http_addr = "0.0.0.0:8080"
# Prometheus metrics 端口（通过 /metrics 端点访问）
metrics_addr = "0.0.0.0:9090"

# eBPF 配置
[ebpf]
# 模式: "xdp"（推荐，高性能入站过滤）或 "tc"（支持出站过滤）
mode = "tc"
# XDP flags（仅 mode = "xdp" 时有效）:
#   - "default": 自动选择
#   - "skb": Generic XDP (兼容性最好)
#   - "driver": Native XDP (需要驱动支持)
#   - "hw": Hardware offload (需要网卡支持)
xdp_flags = "default"
# TC 方向（仅 mode = "tc" 时有效）: "ingress", "egress", 或 "both"
tc_direction = "ingress"
# eBPF 程序路径（可选，默认自动搜索）
# xdp_program_path = "/path/to/rdns-xdp"
# tc_program_path = "/path/to/rdns-tc"

# 过滤配置
# 过滤逻辑：白名单优先，然后检查黑名单
#   1. 如果 IP/域名 在白名单中 -> 放行
#   2. 如果 IP/域名 在黑名单中 -> 过滤
#   3. 否则 -> 放行
[filter]

# IP 过滤（在 eBPF 内核态执行，高性能）
[filter.ip]
# IP 黑名单
blacklist = [
    # "192.168.1.100",
    # "10.0.0.1",
]
# IP 白名单（优先级高于黑名单）
whitelist = []

# 域名过滤（在用户态执行，支持通配符）
[filter.domain]
# 域名黑名单
# 支持通配符:
#   - "*.example.com" - 匹配所有 example.com 的子域名
#   - "ads.*" - 匹配所有以 ads. 开头的域名
#   - "*tracking*" - 匹配包含 tracking 的域名
blacklist = [
    # "*.malware.com",
    # "ads.example.com",
    # "*tracking*",
]
# 域名白名单
whitelist = []

# 日志配置
[logging]
# 日志级别: trace, debug, info, warn, error
level = "info"
